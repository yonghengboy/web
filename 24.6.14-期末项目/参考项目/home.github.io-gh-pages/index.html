<!DOCTYPE html>
<html>

<head>
    <!-- Meta 标签，用于设置网页的基本信息 -->
    <meta charset="utf-8"> <!-- 设置字符编码为UTF-8 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- 兼容IE浏览器的edge模式 -->
    <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- 设置视口的宽度，适应不同设备 -->
    <meta name="description" content="Dmego Home"> <!-- 网页描述信息 -->
    <meta name="keywords" content="Dmego,Homepage"> <!-- 网页关键词 -->
    <meta name="author" content="Dmego"> <!-- 网页作者 -->
    <title>Dmego Home</title> <!-- 网页标题 -->

    <!-- 引入外部样式表 -->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/dmego-home-page@latest/assets/css/onlinewebfonts.css"/>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/dmego-home-page@latest/assets/css/vno.css">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/dmego-home-page@latest/assets/css/iconfont.css">
    <!-- Apple触摸图标和网页图标 -->
    <link rel="apple-touch-icon" href="https://unpkg.com/dmego-home-page@latest/apple-touch-icon.png">
    <link rel="icon" href="https://unpkg.com/dmego-home-page@latest/favicon.ico">

    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            width: 100%;
        }
        #backgroundCanvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            width: 100%;
            height: 100%;
        }
        .panel-cover {
            position: relative;
            z-index: 1;
        }
    </style>
</head>

<body>
    <!-- 动态背景Canvas -->
    <canvas id="backgroundCanvas"></canvas>

    <!-- 移动端菜单按钮 -->
    <span class="mobile btn-mobile-menu">
        <i class="social iconfont icon-list btn-mobile-menu__icon"></i>
        <i class="social iconfont icon-angleup btn-mobile-close__icon hidden"></i>
    </span>
    
    <!-- 页眉部分 -->
    <header id="panel" class="panel-cover">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content">
                    
                    <!-- 带有动画效果的圆形图片和信息 -->
                    <div class="ih-item circle effect right_to_left">            
                        <a href="#" title="" class="blog-button">
                            <div class="img"><img src="https://unpkg.com/dmego-home-page@latest/assets/img/logo3.jpg" alt="img" class="js-avatar iUp profilepic"></div>
                            <div class="info iUp">
                                <div class="info-back">
                                    <h2>Fighting</h2> <!-- 显示文字“Fighting” -->
                                    <p>2024 · 坚持</p> <!-- 显示文字“2024 · 坚持” -->
                                </div>
                            </div>
                        </a>
                    </div>

                    <!-- 网站标题 -->
                    <h1 class="panel-cover__title panel-title iUp">
                        <a href="#" title="Dmego Home">Dmego</a>
                    </h1>

                    <!-- 网站副标题 -->
                    <p class="panel-cover__subtitle panel-subtitle iUp">Code Create Life</p>

                    <!-- 分割线 -->
                    <hr class="panel-cover__divider iUp" />

                    <!-- 描述信息 -->
                    <p id="description" class="panel-cover__description iUp">
                        如何得与凉风约, 不共尘沙一并来!
                        <br/>
                        <strong>-「中牟道中」</strong>
                    </p>

                    <!-- 导航栏 -->
                    <div class="navigation-wrapper iUp">
                        <div>
                            <nav class="cover-navigation cover-navigation--primary">
                                <ul class="navigation">
                                    <li class="navigation__item">
                                        <a href="/" class="blog-button">首页</a>
                                    </li>
                                    <li class="navigation__item">
                                        <a href="https://dmego.cn" class="blog-button" target="_blank">博客</a>
                                    </li>
                                    <li class="navigation__item">
                                        <a href="https://r.dmego.cn" class="blog-button" target="_blank">简历</a>
                                    </li>
                                    <li class="navigation__item">
                                        <a href="https://dmego.cn/about/" class="blog-button" target="_blank">关于</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>

                        <!-- 社交导航栏 -->
                        <div class="iUp">
                            <nav class="cover-navigation navigation--social">
                                <ul class="navigation">
                                    <li class="navigation__item">
                                        <a href="https://github.com/dmego/" title="github" target="_blank">
                                            <i class='social iconfont icon-github'></i>
                                            <span class="label">github</span>
                                        </a>
                                    </li>
                                    <li class="navigation__item">
                                        <a href="http://www.cnblogs.com/dmego/" title="cnblogs" target="_blank">
                                            <i class='social iconfont icon-cnblogs'></i>
                                            <span class="label">cnblogs</span>
                                        </a>
                                    </li>
                                    <li class="navigation__item">
                                        <a href="https://www.zhihu.com/people/dmego/" title="zhihu" target="_blank">
                                            <i class='social iconfont icon-zhihu'></i>
                                            <span class="label">zhihu</span>
                                        </a>
                                    </li>
                                    <li class="navigation__item">
                                        <!-- 加密的邮箱地址，通过解密JavaScript函数显示 -->
                                        <a href="javascript:decryptEmail('ZG1lYWdvQGdtYWlsLmNvbQ==');" title="email">
                                            <i class='social iconfont icon-email'></i>
                                            <span class="label">email</span>
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-cover--overlay cover-slate"></div>
        </div>

        <!-- 备案信息（已注释掉） -->
        <!-- 
        <div class="beian iUp">
            <a class="icp" href="http://www.miitbeian.gov.cn/publish/query/indexFirst.action" target="_blank">XXX</a>
            <a class="gwab" href="http://www.beian.gov.cn/portal/recordQuery" target="_blank">XXX</a>
        </div> 
        -->

        <!-- 页脚备注信息 -->
        <div class="remark iUp">
            <p class="power">Powered By 
                <a href="https://github.com/features/actions" target="_blank"> GitHub Actions </a> And 
                <a href="https://hitokoto.cn/" target="_blank"> Hitokoto </a>
            </p>
        </div>
    </header>

    <!-- 引入外部JavaScript文件 -->
    <script type="text/javascript" src="https://unpkg.com/dmego-home-page@latest/assets/js/main.js"></script>
    <script type="text/javascript" src="./assets/json/images.json?cb=getBingImages"></script>
    
    <!-- 动态背景效果 -->
    <script type="text/javascript">
        // 动态背景效果
        window.onload = function () {
            // 确保canvas覆盖整个背景
            var canvas = document.getElementById('backgroundCanvas'),
                ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            ctx.lineWidth = .3;
            ctx.strokeStyle = (new Color(150)).style;

            var mousePosition = {
                x: 30 * canvas.width / 100,
                y: 30 * canvas.height / 100
            };

            // 定义点和线条的相关参数
            var dots = {
                nb: 1500,          // 点的数量
                distance: 50,      // 点之间的最大距离
                d_radius: 100,     // 鼠标影响的半径
                array: [],         // 存放点的数组
                randomLines: []    // 存放随机线条的数组
            };

            // 最大线条长度
            var maxLineLength = 80;

            // 计算两个组件的加权平均值
            function mixComponents(comp1, weight1, comp2, weight2) {
                return (comp1 * weight1 + comp2 * weight2) / (weight1 + weight2);
            }

            // 计算两个点颜色的平均值
            function averageColorStyles(dot1, dot2) {
                var color1 = dot1.color,
                    color2 = dot2.color;

                var r = mixComponents(color1.r, dot1.radius, color2.r, dot2.radius),
                    g = mixComponents(color1.g, dot1.radius, color2.g, dot2.radius),
                    b = mixComponents(color1.b, dot1.radius, color2.b, dot2.radius);
                return createColorStyle(Math.floor(r), Math.floor(g), Math.floor(b));
            }

            // 生成随机颜色值
            function colorValue(min) {
                return Math.floor(Math.random() * 255 + min);
            }

            // 创建颜色样式
            function createColorStyle(r, g, b) {
                return 'rgba(' + r + ',' + g + ',' + b + ', 0.8)';
            }

            // 定义颜色对象
            function Color(min) {
                min = min || 0;
                this.r = colorValue(min);
                this.g = colorValue(min);
                this.b = colorValue(min);
                this.style = createColorStyle(this.r, this.g, this.b);
            }

            // 定义点对象
            function Dot() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;

                this.vx = -.5 + Math.random();
                this.vy = -.5 + Math.random();

                this.radius = Math.random() * 2;

                this.color = new Color();
            }

            Dot.prototype = {
                draw: function () {
                    ctx.beginPath();
                    ctx.fillStyle = this.color.style;
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
                    ctx.fill();
                }
            };

            // 移动点的位置
            function moveDots() {
                for (i = 0; i < dots.nb; i++) {
                    var dot = dots.array[i];

                    // 碰到画布边界时反弹
                    if (dot.y < 0 || dot.y > canvas.height) {
                        dot.vx = dot.vx;
                        dot.vy = -dot.vy;
                    } else if (dot.x < 0 || dot.x > canvas.width) {
                        dot.vx = -dot.vx;
                        dot.vy = dot.vy;
                    }

                    dot.x += dot.vx;
                    dot.y += dot.vy;
                }

                // 检查随机线条的存活时间和距离
                var currentTime = Date.now();
                dots.randomLines = dots.randomLines.filter(function (line) {
                    var distance = Math.sqrt(Math.pow(line.dot1.x - line.dot2.x, 2) + Math.pow(line.dot1.y - line.dot2.y, 2));
                    return currentTime - line.timestamp < line.lifetime && distance < dots.distance * 2 && distance < maxLineLength;
                });

                // 如果线条数量少于50，添加新的随机线条
                while (dots.randomLines.length < 80) {
                    var dot1 = dots.array[Math.floor(Math.random() * dots.nb)];
                    var dot2 = dots.array[Math.floor(Math.random() * dots.nb)];
                    var distance = Math.sqrt(Math.pow(dot1.x - dot2.x, 2) + Math.pow(dot1.y - dot2.y, 2));
                    if (dot1 !== dot2 && distance < dots.distance * 2 && distance < maxLineLength) {
                        dots.randomLines.push({
                            dot1: dot1,
                            dot2: dot2,
                            timestamp: currentTime,
                            lifetime: Math.random() * 5000 + 5000 // 5到10秒随机时间
                        });
                    }
                }
            }

            // 连接点之间的线条
            function connectDots() {
                for (i = 0; i < dots.nb; i++) {
                    for (j = i + 1; j < dots.nb; j++) { // 改成 j = i + 1，避免重复连线
                        var i_dot = dots.array[i];
                        var j_dot = dots.array[j];

                        var distance = Math.sqrt(Math.pow(i_dot.x - j_dot.x, 2) + Math.pow(i_dot.y - j_dot.y, 2));
                        if (distance < dots.distance && distance < maxLineLength) {
                            if ((i_dot.x - mousePosition.x) < dots.d_radius && (i_dot.y - mousePosition.y) < dots.d_radius && (i_dot.x - mousePosition.x) > -dots.d_radius && (i_dot.y - mousePosition.y) > -dots.d_radius) {
                                ctx.beginPath();
                                ctx.strokeStyle = averageColorStyles(i_dot, j_dot);
                                ctx.moveTo(i_dot.x, i_dot.y);
                                ctx.lineTo(j_dot.x, j_dot.y);
                                ctx.stroke();
                                ctx.closePath();
                            }
                        }
                    }
                }

                // 绘制随机线条
                dots.randomLines.forEach(function (line) {
                    var distance = Math.sqrt(Math.pow(line.dot1.x - line.dot2.x, 2) + Math.pow(line.dot1.y - line.dot2.y, 2));
                    if (distance < maxLineLength) {
                        ctx.beginPath();
                        ctx.strokeStyle = averageColorStyles(line.dot1, line.dot2);
                        ctx.moveTo(line.dot1.x, line.dot1.y);
                        ctx.lineTo(line.dot2.x, line.dot2.y);
                        ctx.stroke();
                        ctx.closePath();
                    }
                });
            }

            // 创建点
            function createDots() {
                for (i = 0; i < dots.nb; i++) {
                    dots.array.push(new Dot());
                }
            }

            // 绘制点
            function drawDots() {
                for (i = 0; i < dots.nb; i++) {
                    var dot = dots.array[i];
                    dot.draw();
                }
            }

            // 动画函数
            function animateDots() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                moveDots();
                connectDots();
                drawDots();
                requestAnimationFrame(animateDots);
            }

            // 初始化并开始动画
            createDots();
            requestAnimationFrame(animateDots);

            // 将鼠标事件监听器绑定到 window
            window.addEventListener('mousemove', function (e) {
                mousePosition.x = e.pageX;
                mousePosition.y = e.pageY;
            });

            // 将鼠标离开事件监听器绑定到 window
            window.addEventListener('mouseleave', function (e) {
                mousePosition.x = canvas.width / 2;
                mousePosition.y = canvas.height / 2;
            });
        }
    </script>
</body>
</html>
